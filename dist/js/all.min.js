angular.module("ctfApp",["ionic","RongWebIMWidget","ctfApp.tabs","ctfApp.home","ctfApp.franchisee","ctfApp.points","ctfApp.personal","cftApp.httpFactory","cftApp.slideBox","ctfApp.cusServices","ctfApp.goodsDetail","cftApp.myOrder","ctfApp.pointsBill","cftApp.slideBox","ctfApp.myShCart","ctfApp.myPoints","ctfApp.myCollect","ctfApp.shopAddress","ctfApp.payRecord","ctfApp.appraise","ctfApp.orderDetail"]).config([function(){}]),angular.module("ctfApp.appraise",[]).config(["$stateProvider",function(o){o.state("tabs.appraise",{url:"appraise",views:{"tabs-personal":{templateUrl:"appraise.html",controller:"appraiseController"}}})}]).controller("appraiseController",["$scope",function(o){function t(o){var t=angular.element(o.currentTarget).children();if(o.target!=o.currentTarget){t.removeClass("active");for(var e=0;e<5;e++)if(t.eq(e).addClass("active"),t[e]==o.target){t.eq(e).addClass("active");break}}}o.appraise={choseStar:t}}]),angular.module("ctfApp.cusServices",["RongWebIMWidget"]).controller("cusServicesController",["$scope","",function(o){console.log("$$$$"),RongCustomerService.init({appkey:" m7ua80gbm7jfm ",token:"kwgZ8fNdE8gJj+nhALYtL9TdqtWeP+zOLoOqGqlK+mwdP/q4SjystMLOkhq4X5MnQ8sqKP07fBtmmgjTT9OAew==",customerServiceId:"wjw123",reminder:"在线咨询",position:RongCustomerService.Position.left})}]),angular.module("ctfApp.franchisee",[]).config(["$stateProvider",function(o){o.state("tabs.franchisee",{url:"/franchisee",views:{"tabs-franchisee":{templateUrl:"tabs_franchisee.html",controller:"franchiseeController"}}})}]).controller("franchiseeController",["$scope",function(o){}]),angular.module("ctfApp.goodsDetail",[]).config(["$stateProvider",function(o){o.state("tabs.goodsDetail",{url:"/goodsDetail",views:{"tabs-home":{templateUrl:"goodsDetail.html",controller:"goodsDetailController"}}})}]).controller("goodsDetailController",["$scope","$ionicTabsDelegate","$ionicModal","$state","$ionicLoading",function(o,t,e,r,n){function a(o){o.stopPropagation();var t=angular.element(o.currentTarget).children()[0],e=angular.element(o.currentTarget).children()[1],r=t.getAttribute("src");r.indexOf("collectStar")>-1?(r=r.replace("collectStar","commentfull"),e.innerText="已收藏",n.show({template:"已收藏",noBackdrop:!0,duration:500}),t.setAttribute("src",r)):(r=r.replace("commentfull","collectStar"),t.setAttribute("src",r),e.innerText="收藏",n.show({template:"取消收藏",noBackdrop:!0,duration:500}))}function i(t){t.stopPropagation();var e=angular.element(t.currentTarget).children(),r=angular.element(t.target);switch(e.removeClass("active"),r.addClass("active"),r.text()){case"商品详情":o.goodsDetail.filePath="realDetail.html";break;case"商品参数":o.goodsDetail.filePath="goodsParams.html";break;default:o.goodsDetail.filePath="appraise.html"}}function s(){o.goodsDetail.modal.show()}function l(t){o.shopCartModal.goodsNum=o.shopCartModal.goodsNum+t,o.shopCartModal.goodsNum||(o.shopCartModal.goodsNum=1)}function c(){r.go("tabs.home")}function p(){n.show({template:"已加入购物车",noBackdrop:!0,duration:500})}function d(){r.go("tabs.myShCart")}o.goodsDetail={addCollect:a,selected:i,filePath:"realDetail.html",openShoppingCart:s,goHomePage:c,addShoppingCart:p,goShoppingCart:d},o.shopCartModal={goodsNum:1,changeNum:l},e.fromTemplateUrl("shoppingCartModal.html",{scope:o,animation:"slide-in-up"}).then(function(t){o.goodsDetail.modal=t}),o.$on("$ionicView.beforeEnter",function(){t.showBar(!1)})}]),angular.module("ctfApp.home",[]).config(["$stateProvider",function(o){o.state("tabs.home",{url:"/home",views:{"tabs-home":{templateUrl:"tabs_home.html",controller:"homeController"}}})}]).controller("homeController",["$scope","$http","$ionicSideMenuDelegate","$ionicModal","$state","$ionicTabsDelegate","$ionicGesture","RongCustomerService",function(o,t,e,r,n,a,i,s){function l(t){t.stopPropagation();var e=document.querySelector(".scroll-content");e.setAttribute("has-bouncing","false");var r=0,n=0,a=t.target;void 0===o.home.dragPosition.x?(o.home.dragPosition.x=t.gesture.center.pageX,o.home.dragPosition.y=t.gesture.center.pageY,o.home.dragPosition.starLeft=a.offsetLeft):(r=t.gesture.center.pageX-o.home.dragPosition.x,n=t.gesture.center.pageY-o.home.dragPosition.y,console.log(r,n),a.style.left=(r+a.offsetLeft)/10+"rem",a.style.top=(n+a.offsetTop)/10+"rem",o.home.dragPosition.x=t.gesture.center.pageX,o.home.dragPosition.y=t.gesture.center.pageY)}function c(t){console.log("end"),t.stopPropagation();var e=document.body;e.setAttribute("has-bouncing","false");var r=t.target;r.style.left="",r.style.right="1rem",o.home.dragPosition={}}function p(t,e){t.stopPropagation(),o.home.modal.show()}function d(){n.go("tabs.goodsDetail")}function m(t){o.shopCartModal.goodsNum=o.shopCartModal.goodsNum+t,o.shopCartModal.goodsNum||(o.shopCartModal.goodsNum=1)}o.home={goodsData:"",dragEnd:c,dragPosition:{},openShoppingCart:p,modal:"",goGoodsDetail:d,bannerData:""},o.shopCartModal={goodsNum:1,changeNum:m},o.$on("$destroy",function(){o.home.modal.remove()}),o.$on("$ionicView.beforeEnter",function(o){console.log(o),a.showBar(!0),e.canDragContent(!1)}),r.fromTemplateUrl("shoppingCartModal.html",{scope:o,animation:"slide-in-up"}).then(function(t){o.home.modal=t});var g="http://114.112.94.166/sunny/wap/api/getGoods";t.get(g).then(function(t){t=t.data,console.log(t),console.log(t.bannerData,"???"),o.home.goodsData=t.goodsData,o.home.bannerData=t.bannerData});var u=document.querySelector(".home .scroll-content").offsetWidth,f=document.querySelector(".home .scroll-content").offsetHeight;s.init({appkey:"m7ua80gbm7jfm",token:"JgfBqAr0BPyPWIO4LIJKVNTdqtWeP+zOLoOqGqlK+mwdP/q4SjystKOpYMMHz4uM8KeMTNp1LzaMQgoDTiE67g==",customerServiceId:"KEFU148292934047516",reminder:" ",style:{width:u,height:f,left:10},position:s.Position.right,displayMinButton:!0,onSuccess:function(){console.log(t);var o=angular.element(document.getElementById("rong-widget-minbtn"));o.css("bottom","8rem"),o.css("right","2rem");var t=angular.element(document.getElementById("rong-widget-minbtn"));i.on("drag",l,t),i.on("dragend",c,t)}})}]),angular.module("ctfApp.myCollect",[]).config(["$stateProvider",function(o){o.state("tabs.myCollect",{url:"/myCollect",views:{"tabs-personal":{templateUrl:"myCollect.html",controller:"myCollectController"}}})}]).controller("myCollectController",["$scope",function(o){}]),angular.module("cftApp.myOrder",[]).config(["$stateProvider",function(o){o.state("tabs.myOrder",{url:"/myOrder",views:{"tabs-personal":{templateUrl:"myOrder.html",controller:"myOrderController"}}})}]).controller("myOrderController",["$rootScope","$scope","$state","$ionicViewSwitcher","$ionicPopup","$ionicTabsDelegate",function(o,t,e,r,n,a){function i(o){}function s(o){var e=angular.element(o.currentTarget).children(),r=angular.element(o.target);if(console.log(r.text()),o.currentTarget!=o.target)switch(e.removeClass("active"),r.addClass("active"),r.text()){case"待付款":t.myOrder.keyWords="待付款";break;case"待发货":t.myOrder.keyWords="待发货";break;case"待收货":t.myOrder.keyWords="待收货";break;case"待评价":t.myOrder.keyWords="交易成功";break;default:t.myOrder.keyWords=""}}function l(o,e){e.stopPropagation(),t.myOrder.popup=n.show({cssClass:"myOrder",template:"确认要取消订单吗？",buttons:[{text:"取消",onTap:function(){}},{text:"确定",onTap:function(){o.status="交易关闭"}}]}),console.log(t.myOrder.popup)}function c(o,t){t.stopPropagation(),console.log("跳转到微信支付页面")}function p(o,e){e.stopPropagation(),t.myOrder.popup=n.show({cssClass:"myOrder refund",template:'<p>申请退款</p><textarea placeholder="请输入申请退款的原因？"></textarea><div>10/100</div>',buttons:[{text:"取消",onTap:function(o){}},{text:"确定",onTap:function(){o.status="退款中"}}]})}function d(o,e){e.stopPropagation(),t.myOrder.popup=n.show({cssClass:"myOrder",template:"确认是否已收到货？",buttons:[{text:"取消",onTap:function(){}},{text:"确定",onTap:function(){o.status="交易成功"}}]})}function m(o,t){t.stopPropagation(),e.go("tabs.appraise")}t.myOrder={keyWords:"",navData:s,allData:"",cancelBill:l,payment:c,refund:p,confirm:d,appraise:m,goOrderDetail:i,popup:""},t.$on("$ionicView.beforeEnter",function(){a.showBar(!0)}),t.$on("$ionicView.beforeLeave",function(){console.log("???"),t.myOrder.popup&&t.myOrder.popup.close()}),t.myOrder.allData=[{serial:"23456788",orde:"3",status:"待付款",goodsArray:[{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",orde:"3",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",orde:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"}],totalNum:"4",totalPrice:"1032.00",freight:"30.00"},{serial:"23456788",orde:"0",status:"待收货",goodsArray:[{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",orde:"5",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"}],totalNum:"4",totalPrice:"1032.00",freight:"30.00"},{serial:"23456788",orde:"2",status:"交易成功",isAppraise:!1,goodsArray:[{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",orde:"1",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"}],totalNum:"4",totalPrice:"1032.00",freight:"30.00"},{serial:"23456788",orde:"5",status:"待发货",goodsArray:[{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"}],totalNum:"4",totalPrice:"1032.00",freight:"30.00"},{serial:"23456788",orde:"7",status:"退款中",goodsArray:[{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"},{imgSrc:"dist/images/myOrder.png",price:"258",origin:"99",num:"2",sname:"买一份送一份日汪洋澄湖大闸蟹全母螃蟹3.2-3.0两6只鲜活现货礼盒装"}],totalNum:"4",totalPrice:"1032.00",freight:"30.00"}]}]),angular.module("ctfApp.myPoints",[]).config(["$stateProvider",function(o){o.state("tabs.myPoints",{url:"myPoints",views:{"tabs-personal":{templateUrl:"myPoints.html",controller:"myPointsController"}}})}]).controller("myPointsController",["$scope","$http","$state",function(o,t,e){function r(){e.go("tabs.personal"),e.go("tabs.points")}o.myPoints={goPoints:r}}]),angular.module("ctfApp.myShCart",[]).config(["$stateProvider",function(o){o.state("tabs.myShCart",{url:"myShCart",views:{"tabs-personal":{templateUrl:"myShoppingCart.html",controller:"myShCartController"}}})}]).controller("myShCartController",["$scope","$http","$ionicPopup",function(o,t,e){function r(){o.myShCart.isLoadMore=!0,i=0;var e="http://114.112.94.166/sunny/wap/api/ushoppingCart?page=0";t.get(e).then(function(t){o.myShCart.goodsData=t.data.shoppingCart}).finally(function(){}),o.$broadcast("scroll.refreshComplete")}function n(){i+=1,console.log("loadMore");var e="http://114.112.94.166/sunny/wap/api/ushoppingCart?page="+i;t.get(e).then(function(t){t=t.data,t.shoppingCart<10&&(o.myShCart.isLoadMore=!1),o.myShCart.goodsData=o.myShCart.goodsData.concat(t.shoppingCart)}).finally(function(){o.$broadcast("scroll.infiniteScrollComplete")})}function a(t,r){r.stopPropagation(),o.myShCart.popup=e.show({cssClass:"myOrder",template:"确实要删除该商品吗？",buttons:[{text:"取消",onTap:function(){}},{text:"确定",onTap:function(){var e=o.myShCart.goodsData.indexOf(t);o.myShCart.goodsData.splice(e,1)}}]})}o.myShCart={goodsData:[],doRefresh:r,loadMore:n,isLoadMore:!0,deleteGoods:a,popup:""};var i=-1;t({url:"http://114.112.94.166/sunny/wap/api/ushoppingCart",method:"DELETE",params:{id:"19"}}).then(function(o){console.log(o)})}]),angular.module("ctfApp.orderDetail",[]).config(["$stateProvider",function(o){o.state("tabs.orderDetail",{url:"/orderDetail",views:{"tabs-personal":{templateUrl:"orderDetail.html",controller:"orderDetailController"}}})}]).controller("orderDetailController",["$scope",function(o){}]),angular.module("ctfApp.payRecord",[]).config(["$stateProvider",function(o){o.state("tabs.payRecord",{url:"/payRecord",views:{"tabs-personal":{templateUrl:"payRecord.html",controller:"payRecordController"}}})}]).controller("payRecordController",["$scope",function(o){}]),angular.module("ctfApp.personal",[]).config(["$stateProvider",function(o){o.state("tabs.personal",{url:"/personal",views:{"tabs-personal":{templateUrl:"tabs_personal.html",controller:"personalController"}}})}]).controller("personalController",["$scope","$state","$ionicModal",function(o,t,e){function r(){t.go("tabs.myOrder")}function n(){t.go("tabs.myShCart")}function a(){o.personal.modal.show()}function i(){t.go("tabs.myPoints")}function s(){t.go("tabs.myCollect")}function l(){t.go("tabs.shopAddress")}function c(){t.go("tabs.payRecord")}o.personal={goMyOrder:r,goMyShCart:n,openShareModal:a,modal:"",goMyPoints:i,goMyCollect:s,goAddress:l,goPayRecord:c},e.fromTemplateUrl("shareModal.html",{scope:o,animation:"fade-in"}).then(function(t){o.personal.modal=t})}]),angular.module("ctfApp.pointsBill",[]).config(["$stateProvider",function(o){o.state("tabs.pointsBill",{url:"pointsBill",views:{"tabs-points":{templateUrl:"pointsBill.html",controller:"pointsBillController"}}})}]).controller("pointsBillController",["$scope",function(o){}]),angular.module("ctfApp.points",[]).config(["$stateProvider",function(o){o.state("tabs.points",{url:"/points",views:{"tabs-points":{templateUrl:"tabs_points.html",controller:"pointsController"}}})}]).controller("pointsController",["$scope","$http","$ionicSideMenuDelegate","$ionicModal","$state","$ionicTabsDelegate",function(o,t,e,r,n,a){function i(t,e){t.stopPropagation(),o.points.modal.show()}function s(){}function l(t){o.shopCartModal.goodsNum=o.shopCartModal.goodsNum+t,o.shopCartModal.goodsNum||(o.shopCartModal.goodsNum=1)}function c(o){o.stopPropagation(),n.go("tabs.pointsBill")}o.points={goodsData:"",openShoppingCart:i,modal:"",goGoodsDetail:s,goPointsBill:c},o.shopCartModal={goodsNum:1,changeNum:l},o.$on("$destroy",function(){o.points.modal.remove()}),o.$on("$ionicView.beforeEnter",function(o){a.showBar(!0)}),r.fromTemplateUrl("shoppingCartModal.html",{scope:o,animation:"slide-in-up"}).then(function(t){o.points.modal=t});var p="http://114.112.94.166/sunny/wap/api/getGoods";t.get(p).then(function(t){t=t.data,console.log(t),o.points.goodsData=t.goodsData})}]),angular.module("ctfApp.shopAddress",[]).config(["$stateProvider",function(o){o.state("tabs.shopAddress",{url:"/shopAddress",views:{"tabs-personal":{templateUrl:"shopAddress.html",controller:"shopAddressController"}}})}]).controller("shopAddressController",["$scope",function(o){}]),angular.module("ctfApp.tabs",[]).config(["$stateProvider","$urlRouterProvider",function(o,t){o.state("tabs",{url:"/tabs",distract:!0,views:{indexPage:{templateUrl:"tabs.html",controller:"tabsController"}}}),t.otherwise("/tabs/home")}]).controller("tabsController",["$scope","$ionicSideMenuDelegate","$timeout","$ionicLoading","$state",function(o,t,e,r,n){function a(){console.log("???"),e(function(){t.$getByHandle("mainPageMenus").toggleRight()})}function i(){r.show({template:"已加入购物车",noBackdrop:!0,duration:500}),n.go("tabs.myShCart")}o.tabs={slideToggle:a,addShopCart:i},o.$on("$stateChangeSuccess",function(o,e,r){var n=function(o){document.getElementsByTagName("body")[0];document.title=o;var t=document.createElement("iframe");t.setAttribute("src","../empty.png"),t.addEventListener("load",function(){setTimeout(function(){document.body.removeChild(t)})}),document.body.appendChild(t)};switch(e.url){case"/home":n("SUNNY SHU官方商城");break;case"/points":n("我的积分");break;case"/franchisee":n("加盟店");break;case"/personal":n("个人中心")}var a=angular.element(document.getElementById("rong-widget-minbtn"));switch(e.url){case"/home":case"/points":a.css("display","block");break;default:a.css("display","none")}t.canDragContent(!1)})}]),angular.module("cftApp.httpFactory",[]).factory("HttpFactory",["$http","$q",function(o,t){return{getData:function(e,r){if(e){var n=t.defer();return e="http://localhost:3000/?myUrl="+encodeURIComponent(e),r=r?r:"GET",o({url:e,method:r,timeout:2e4}).then(function(o){o=o.data,n.resolve(o)},function(o){n.reject(o)}),n.promise}}}}]),angular.module("cftApp.slideBox",[]).directive("mgSlideBox",[function(){return{restrict:"E",scope:{sourceArray:"="},template:'<div class="topCarousel"><ion-slide-box  does-continue="true" delegate-handle="topCarouselSlideBox" on-slide-changed="slideHasChanged($index)" show-pager="true"  ng-if="isShowSlideBox" on-drag="drag($event)"> <ion-slide ng-repeat="img in sourceArray track by $index" ng-click="goToDetailView($index)"><img ng-src="{{addPrefix(img.image_url)}}" class="topCarouselImg"></ion-slide> </ion-slide-box></div>',controller:["$scope","$element","$ionicSlideBoxDelegate","$timeout",function(o,t,e,r){o.goToDetailView=function(o){},o.addPrefix=function(o){return o="http://114.112.94.166"+o},o.$watch("sourceArray",function(t,e){t&&t.length&&(e&&e.length&&t.length!=e.length?(o.isShowSlideBox=!1,r(function(){o.isShowSlideBox=!0})):o.isShowSlideBox=!0)}),o.drag=function(o){o.stopPropagation(),e.loop(!0)}}],replace:!0,link:function(o,t,e){}}}]);